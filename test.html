<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Model Viewer</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; width: 100vw; height: 100vh; }
    #uiControls { position: absolute; bottom: 0.5rem; right: .5rem; z-index: 1; }
	button {margin:1rem;vertical-align:middle;cursor:pointer;}
	button img {border-radius: 9999px;vertical-align:middle;}
  </style>
</head>
<body>

<canvas id="scene"></canvas>

<div id="uiControls">
  <button onclick="changeTexture('oak')">
  <img src="oak.jpg" width="25" height="25"> 
  Egetræ
  </button>
  <button onclick="changeTexture('balsa')">
  <img src="balsa.jpg" width="25" height="25">
  Balsatræ
  </button>
  <button onclick="changeTexture('plastic')">
  <img src="plastic.jpg" width="25" height="25">
  Syntetisk plastik
  </button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three/examples/js/loaders/GLTFLoader.min.js"></script>

<script>
const canvas = document.getElementById('scene')

const renderer = new THREE.WebGLRenderer({ canvas, antialias: true })
renderer.setClearColor(0xffffff)
renderer.setSize(window.innerWidth, window.innerHeight)

const scene = new THREE.Scene()

const camera = new THREE.PerspectiveCamera(
  75,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
)

camera.position.set(2, 2, 6)

const ambient = new THREE.AmbientLight(0xffffff, 0.2)
scene.add(ambient)

const directional = new THREE.DirectionalLight(0xffffff, 3)
directional.position.set(-5, 5, 10)
scene.add(directional)


let model

const loader = new THREE.GLTFLoader()
loader.load('model.glb', gltf => {
  model = gltf.scene
  scene.add(model)
  model.position.set(2, 1, 1)
  model.rotation.y += 0.45


const texture = new THREE.TextureLoader().load('oak.jpg')

model.traverse(obj => {
  if (obj.isMesh && obj.material) {
    obj.material.map = texture
    obj.material.roughness = 0.7
    obj.material.metalness = 0.0
    obj.material.needsUpdate = true
  }
})


}, undefined, error => {
  console.error('Failed to load model:', error)
})






function animate() {
  requestAnimationFrame(animate)
  renderer.render(scene, camera)
}
animate()

function changeTexture(materialType) {
  const texture = new THREE.TextureLoader().load(materialType + '.jpg')
  if (!model) return
  model.traverse(obj => {
    if (obj.isMesh) {
	    obj.material.map = texture
        obj.material.roughness = 0.7
        obj.material.metalness = 0.0
        obj.material.needsUpdate = true
    }
  })
}


document.addEventListener('keydown', e => {
  if (!model) return
  switch (e.key) {
    case 'ArrowLeft':
      model.rotation.y -= 0.1
      break
    case 'ArrowRight':
      model.rotation.y += 0.1
      break
    case 'ArrowUp':
      model.rotation.x -= 0.1
      break
    case 'ArrowDown':
      model.rotation.x += 0.1
      break
  }
})

// Mouse controls
let isDragging = false
let previousMousePosition = { x: 0, y: 0 }

canvas.addEventListener('mousedown', e => {
  if (e.button === 0) isDragging = true
})

canvas.addEventListener('mouseup', e => {
  if (e.button === 0) isDragging = false
})

canvas.addEventListener('mousemove', e => {
  if (!isDragging || !model) return

  const deltaMove = {
    x: e.movementX,
    y: e.movementY
  }

  model.rotation.y += deltaMove.x * 0.01
  model.rotation.x += deltaMove.y * 0.01
})


</script>

</body>
</html>
